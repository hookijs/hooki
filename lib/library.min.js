!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Library",[],e):"object"==typeof exports?exports.Library=e():t.Library=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var r=[],n=!0,a=!1,o=void 0;try{for(var u,i=t[Symbol.iterator]();!(n=(u=i.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(1),i=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n(this,t),(0,u.isClass)(e)?this.Class=e:this.target=e,this.handler={},this.current={},this.hooks={before:(0,u.nameFunctions)(r),after:(0,u.nameFunctions)(a)},this.Class?this.decorateClass():this.invokeFunction()}return o(t,[{key:"setCurrent",value:function(t,e,r){this.current={name:t,type:e,action:r}}},{key:"createContextData",value:function(t){var e=this;return function(r){var n=(0,u.createParams)(t,r),a=e.current.action,o=e.current.name;switch(a){case"function":return{name:o,action:a,params:n,stash:{args:r,params:n},self:e.target,get args(){return Object.values(this.params)}};case"set":return{name:o,action:a,value:n.value,stash:{value:n.value},self:e.target};case"setter":return{name:o,action:a,params:n,stash:{args:r,params:n},self:e.target,get args(){return Object.values(this.params)}};case"get":return{name:o,action:a,value:n.value,stash:{value:n.value},self:e.target};case"getter":return{name:o,action:a};default:throw new Error("Action "+a+" do not exists!")}}}},{key:"applyHook",value:function(t,e){t.hookName=e.name;var r=e(t),n=["args","stash","value","action","hookName","type"];if(void 0===r||null===r)throw Error("'"+e.name+"' hook must return context data");return Object.assign(t,u.omit.apply(void 0,[r].concat(n)))}},{key:"processHooks",value:function(t){var e=this;return function(r){var n=Object.assign(r,{type:t}),a=e.current.name;return(e.hooks[t][a]||[]).reduce(e.applyHook,n)}}},{key:"applyOriginalFunction",value:function(t){var e=this;return function(r){var n=void 0;"function"===e.current.action&&(n=r.args),"get"!==e.current.action&&"set"!==e.current.action||(n=[r.value]);var a=t.apply(e.target,n);return void 0===a||null===a?r:Object.assign({},r,{result:a})}}},{key:"decorateFunction",value:function(t){var e=this;return function(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];var u=[n].map(e.createContextData(t)).map(e.processHooks("before")).map(e.applyOriginalFunction(t)).map(e.processHooks("after"));return a(u,1)[0].result}}},{key:"traceCalls",value:function(){var t=this;this.handler={get:function(e,r){function n(t){return t}var a=Reflect.getOwnPropertyDescriptor(e,r);if(void 0!==a&&null!==a){if(a.get){var o=function(t){return t()};return t.setCurrent(r,"get","getter"),t.decorateFunction(a.get)(o)}if("function"==typeof a.value){t.setCurrent(r,"get","function");var u=e[r];return t.decorateFunction(u)}return t.setCurrent(r,"get","get"),t.decorateFunction(n)(e[r])}},set:function(e,r,n){function a(t){return e[r]=t,!0}t.setCurrent(r,"set");var o=Reflect.getOwnPropertyDescriptor(e,r);return o.set?(t.setCurrent(r,"set","setter"),t.decorateFunction(o.set)(n),!0):(t.setCurrent(r,"set","set"),t.decorateFunction(a)(n),!0)}}}},{key:"invokeFunction",value:function(){return this.traceCalls(),this.proxy=new Proxy(this.target,this.handler),this.proxy}},{key:"decorateClass",value:function(){var t=this;return function(){function e(){n(this,e);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return t.target=new(Function.prototype.bind.apply(t.Class,[null].concat(a))),t.traceCalls(),t.proxy=new Proxy(t.target,t.handler),t.proxy}return o(e,[{key:Symbol.toStringTag,get:function(){return"Decorator"}}],[{key:Symbol.hasInstance,value:function(e){if(e.toString){if(/Decorator/.test(e.toString()))return!0}return e instanceof t.Class}}]),e}()}}]),t}();e.default=i,t.exports=e.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return(t+"").replace(/[\/][\/].*$/gm,"").replace(/\s+/g,"").replace(/[\/][*][^\/*]*[*][\/]/g,"").split(/\)[\{=]/,1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)},a=(e.createParams=function(t,e){return n(t).reduce(function(t,r,n){return t[r]=e[n],t},{})},e.omit=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Object.keys(t).reduce(function(e,n){return r.find(function(t){return t===n})||(e[n]=t[n]),e},{})},e.pick=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Object.keys(t).reduce(function(e,n){return r.find(function(t){return t===n})&&(e[n]=t[n]),e},{})},e.nameFunctions=function(t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r].map(function(t,e){return t&&!t.name&&Object.defineProperty(t,"name",{value:"hook-"+(e+1)}),t}),e},{})},Function.prototype.toString),o=function(t){return a.call(t).replace(/^[^{]*{\s*/,"").replace(/\s*}[^}]*$/,"")};e.isClass=function(t){return"function"==typeof t&&(/^class\s/.test(a.call(t))||/classCallCheck\(/.test(o(t)))}}])});